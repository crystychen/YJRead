<!--pages/daily_task/daily_task.wxml-->
<view class='container' style='height: {{windowHeight}}px'>
  <!-- header -->
  <view class='user-infos'>
    <button class="openbtn" wx:if='{{authLevel != 2}}' open-type="getUserInfo" bindgetuserinfo="onGotUserInfo"></button>
    <image class='header_img' src='{{userInfo && userInfo.avatarUrl? userInfo.avatarUrl:"/images/nologinuser.png"}}'></image>
    <view class='infos-detail'>
      <text class='user-name'>{{userInfo.nickName? userInfo.nickName:"点击头像立即登录" }}</text>
      <view class='row'>
        <image class="sm_icon" src='/images/bookMark_active.png'></image>
        <text class='infos-desc'>已有<text class="num">{{gold}}</text>张书签</text>
      </view>
    </view>
  </view>
  <!-- tasklist -->
  <view class='task-lists'>
    <view class='list-item'>
      <view class='item-infos'>
        <text>签到 <text class="task-num">+{{signedDays[signedDays.length-1].number || isSigned[0].number}}</text> 书签</text>
        <text wx:if="{{!isSigned && authLevel == 2}}">完成 (1/1)</text>
        <text wx:else>完成 (0/1)</text>
      </view>
      <view class='btn-wrap'>
        <view class='xs-btn btn disabled' wx:if="{{!isSigned && authLevel == 2}}">已签到</view>
        <view class='xs-btn btn active' wx:else bindtap="showSignModal">去完成</view>
      </view>
    </view>
    <!-- 奖励规则 -->
    <block wx:for="{{rewardList}}" wx:for-index="index" wx:key="index">
      <view class='list-item'>
        <view class='item-infos'>
          <text>{{item[1]}}<text class="task-num">+{{item[2] * item[4]}}</text>书签</text>
          <!-- <text wx:if="{{item[8]}}">{{item[1]}}<text class="task-num">+{{item[8]}}</text>书签</text> -->
          <!-- <text wx:if="{{item[9]}}">{{item[2]}}<text class="task-num">+{{item[9]}}</text>元红包</text> -->
          <text>完成 ({{item[5]}}/{{item[4]}})</text>
        </view>
        <view class='btn-wrap'>
          <view class='xs-btn btn disabled' wx:if="{{item[5] >= item[4]}}">已完成</view>
          <view class='xs-btn btn active' wx:else bindtap='toIndex'>去完成</view>
        </view>
      </view>
    </block>
    <!-- 每日任务邀请好友 -->
    <block wx:for="{{tasklistObj.Invitation}}" wx:for-index="index" wx:key="index">
      <view class='list-item'>
        <view class='item-infos'>
          <text wx:if="{{item[8]}}">{{item[2]}}<text class="task-num">+{{item[8]}}</text>书签</text>
          <text wx:if="{{item[9]}}">{{item[2]}}<text class="task-num">+{{item[9]}}</text>元红包</text>
          <text>完成 ({{item[4]}}/{{item[3]}})</text>
        </view>
        <view class='btn-wrap'>
          <view class='xs-btn btn disabled' wx:if="{{item[10] == 1}}">已领取</view>
          <view class='xs-btn btn active' data-taskId="{{item[0]}}" data-award="{{item[8] || item[9]}}" wx:if="{{item[10] == 0 && item[4] >= item[3]}}" bindtap="onReceive">领取</view>
          <view class='xs-btn btn active' bindtap='showInviteList' wx:if="{{item[4] < item[3]}}">
            去完成
            <!-- <button open-type="share" class='share-btn'></button> -->
          </view>
        </view>
      </view>
    </block>
  </view>
  <text class='tips'>所有任务于每日0点清空</text>
</view>

<!-- 好友邀請文章列表 -->
<view class="modal-mask" bindtap="hideInviteList" catchtouchmove="preventTouchMove" wx:if="{{isInviteList}}"></view>
<view class='modal' catchtouchmove="preventTouchMove" wx:if="{{isInviteList}}">
  <scroll-view scroll-y="true" style="overflow: hidden" style="height: 720rpx;" scroll-with-animation="true">
    <view class='view-list'>
      <block wx:for="{{contentList}}" wx:for-index="index" wx:key="index">
        <view class='view-list-item'>
          <view class='item-infos'>
            <image class='' src='{{item[2]}}'></image>
            <text>{{item[1]}}</text>
          </view>
          <view class='btn-wrap' data-shareurl="{{item[8]}}" data-shareArtid="{{item[0]}}" catchtap="showShareBoard">
            <view class='right-btn'>去邀請</view>
            <!-- <button class="share-btn" open-type='share'></button> -->
          </view>
        </view>
      </block>
    </view>
  </scroll-view>
  <view class='btn active w-vertical-align-l more-btn' bindtap='toIndex'>更多精彩文章</view>
</view>


<!-- 签到面板 -->
<signinmodal modal-hidden="{{isSignedModal}}" bindsignIn="signIn" bindgetUserInfo="getUserInfofromCom" modal-msg="{{signInfo}}" sign-days="{{signDays}}" auth-level="{{authLevel}}" is-signed="{{isSigned}}" />

<popup modal-hidden="{{tipsModal}}" modal-title="恭喜" award="{{signAward}}" modal-type="1" is-currentpage="true" bindtoView="toAwardView"></popup>

<!-- 专属海报 -->
<share-poster modal-hidden="{{isPosterModal}}"></share-poster>
<!-- 分享面板 -->
<share-board modal-hidden="{{isShareBoard}}" putshareurl="{{putshareurl}}" putshareartid="{{putshareartid}}" bindshowPosterModal="showPosterModal"></share-board>